# üöÄ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π CI/CD –¥–ª—è CB500F

## –û–±–∑–æ—Ä GitHub Workflows

### 1. üèóÔ∏è `build-base.yml` - –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞
**–ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `requirements.txt` –∏–ª–∏ `Dockerfile.base`
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ GitHub Actions
- –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞–µ—Ç –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å Python + Playwright + –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- –ü—É–±–ª–∏–∫—É–µ—Ç –≤ Docker Hub –∫–∞–∫ `klimdos/cb500-base:latest`
- –ö—ç—à–∏—Ä—É–µ—Ç —Å–ª–æ–∏ –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø–µ—Ä–µ—Å–±–æ—Ä–æ–∫
- –¢–µ—Å—Ç–∏—Ä—É–µ—Ç –æ–±—Ä–∞–∑ –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å

### 2. ‚ö° `docker-publish.yml` - –£–º–Ω–∞—è —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
**–ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- –ü—Ä–∏ push –≤ main
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç–µ–≥–æ–≤
- –ü—Ä–∏ pull request (—Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç, –±–µ–∑ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏)

**–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
```mermaid
flowchart TD
    A[–ö–æ–º–º–∏—Ç –≤ main] --> B[–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π]
    B --> C{–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å?}
    C -->|requirements.txt| D[–ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –±–∞–∑—É + –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ]
    C -->|–¢–æ–ª—å–∫–æ –∫–æ–¥ src/| E[–ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è]
    C -->|–ù–∏—á–µ–≥–æ –≤–∞–∂–Ω–æ–≥–æ| F[–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–±–æ—Ä–∫—É]
    D --> G[Dockerfile.superfast<br/>~20-30 —Å–µ–∫]
    E --> H[Dockerfile.fast<br/>~60-90 —Å–µ–∫]
```

### 3. üìä `performance-monitor.yml` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:**
- –†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏ –≤—Å–µ—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
- –†–∞–∑–º–µ—Ä—ã –æ–±—Ä–∞–∑–æ–≤
- –ü—Ä–æ—Ü–µ–Ω—Ç —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

## –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ —Å–±–æ—Ä–∫–∏

### üöÄ Superfast (—Å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –±–∞–∑–æ–π)
```yaml
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç klimdos/cb500-base:latest
file: Dockerfile.superfast
time: 20-30 —Å–µ–∫—É–Ω–¥
when: –ö–æ–≥–¥–∞ –µ—Å—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
```

### üêß Fast (—Å Microsoft –±–∞–∑–æ–π)
```yaml
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç mcr.microsoft.com/playwright/python
file: Dockerfile.fast  
time: 60-90 —Å–µ–∫—É–Ω–¥
when: Fallback –∫–æ–≥–¥–∞ –Ω–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–π –±–∞–∑—ã
```

### üêå Original (–ø–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞)
```yaml
# –°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ —Å –Ω—É–ª—è
file: Dockerfile
time: 5-6 –º–∏–Ω—É—Ç
when: –¢–æ–ª—å–∫–æ –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ GitHub

–ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ Settings ‚Üí Secrets and variables ‚Üí Actions:

```bash
DOCKERHUB_USERNAME=klimdos
DOCKERHUB_TOKEN=dckr_pat_xxxxxxxxxxxxx
```

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞:
```bash
# 1. –°–æ–∑–¥–∞—Ç—å –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ (—á–µ—Ä–µ–∑ GitHub Actions)
# –ò–¥–µ–º –≤ Actions ‚Üí "Build Base Image" ‚Üí Run workflow

# 2. –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ
./fast-build.sh build-base
./fast-build.sh push-base
```

### –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
```bash
# 1. –î–µ–ª–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ
git add src/
git commit -m "—É–ª—É—á—à–∏–ª –ø–∞—Ä—Å–∏–Ω–≥"
git push origin main

# 2. GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
#    - –û–ø—Ä–µ–¥–µ–ª–∏—Ç —á—Ç–æ –∏–∑–º–µ–Ω–∏–ª—Å—è —Ç–æ–ª—å–∫–æ –∫–æ–¥
#    - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±—ã—Å—Ç—Ä—É—é —Å–±–æ—Ä–∫—É (~60-90 —Å–µ–∫)
#    - –û–ø—É–±–ª–∏–∫—É–µ—Ç –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑
```

### –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:
```bash
# 1. –ò–∑–º–µ–Ω—è–µ–º requirements.txt
echo "new-package==1.0.0" >> requirements.txt
git add requirements.txt
git commit -m "–¥–æ–±–∞–≤–∏–ª –Ω–æ–≤—É—é –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å"
git push origin main

# 2. GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
#    - –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Å—Ç –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ (5-6 –º–∏–Ω)
#    - –°–æ–±–µ—Ä–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–æ–≤–æ–π –±–∞–∑–æ–π (~20-30 —Å–µ–∫)
#    - –û–ø—É–±–ª–∏–∫—É–µ—Ç –æ–±–∞ –æ–±—Ä–∞–∑–∞
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ —Å–±–æ—Ä–∫–∏:
```bash
# –õ–æ–∫–∞–ª—å–Ω–æ
./fast-build.sh time-test

# –í GitHub Actions
# –ò–¥–µ–º –≤ Actions ‚Üí –≤—ã–±–∏—Ä–∞–µ–º workflow ‚Üí —Å–º–æ—Ç—Ä–∏–º –ª–æ–≥–∏
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—Ä–∞–∑–æ–≤:
```bash
# –ß–µ—Ä–µ–∑ Docker Hub
open "https://hub.docker.com/r/klimdos/cb500-monitor/tags"
open "https://hub.docker.com/r/klimdos/cb500-base/tags"

# –õ–æ–∫–∞–ª—å–Ω–æ
docker images | grep cb500
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –±–∞–∑—ã:
```bash
# –í GitHub Actions
# Actions ‚Üí "Build Base Image" ‚Üí Run workflow ‚Üí force_rebuild: true
```

## –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚è±Ô∏è –ö–∞–∂–¥–∞—è —Å–±–æ—Ä–∫–∞: 6 –º–∏–Ω—É—Ç
- üîÑ 10 —Å–±–æ—Ä–æ–∫ –≤ –¥–µ–Ω—å: 60 –º–∏–Ω—É—Ç
- üìÖ –í –º–µ—Å—è—Ü: 20 —á–∞—Å–æ–≤

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- ‚ö° –ë—ã—Å—Ç—Ä–∞—è —Å–±–æ—Ä–∫–∞: 30 —Å–µ–∫—É–Ω–¥  
- üîÑ 10 —Å–±–æ—Ä–æ–∫ –≤ –¥–µ–Ω—å: 5 –º–∏–Ω—É—Ç
- üìÖ –í –º–µ—Å—è—Ü: 2.5 —á–∞—Å–∞
- üí∞ **–≠–∫–æ–Ω–æ–º–∏—è: 17.5 —á–∞—Å–æ–≤ –≤ –º–µ—Å—è—Ü!**

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

### Pre-commit hook –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –±—ã—Å—Ç—Ä–æ–π —Å–±–æ—Ä–∫–∏:
```bash
# .git/hooks/pre-push
#!/bin/bash
echo "üöÄ Building fast Docker image..."
./fast-build.sh build-fast
```

### VS Code tasks –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
```json
// .vscode/tasks.json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Fast Docker Build",
      "type": "shell",
      "command": "./fast-build.sh build-fast",
      "group": "build",
      "presentation": {
        "echo": true,
        "reveal": "always",
        "focus": false,
        "panel": "shared"
      }
    }
  ]
}
```

## Troubleshooting

### –ï—Å–ª–∏ —Å–±–æ—Ä–∫–∞ –º–µ–¥–ª–µ–Ω–Ω–∞—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:
   ```bash
   docker pull klimdos/cb500-base:latest
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤ GitHub Actions –ª–æ–≥–∞—Ö

3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É —á–µ—Ä–µ–∑ Actions

### –ï—Å–ª–∏ –æ–±—Ä–∞–∑ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤—Å–µ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã:
   ```bash
   docker run --rm klimdos/cb500-monitor:latest ls -la /app/
   ```

2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
   ```bash
   docker run --rm klimdos/cb500-monitor:latest whoami
   ```

### –ï—Å–ª–∏ GitHub Actions –ø–∞–¥–∞–µ—Ç:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã Docker Hub
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—É–±–ª–∏—á–Ω—ã–π –∏–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã Docker Hub

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–í—Ä–µ–º—è —Å–±–æ—Ä–∫–∏**: –° 6 –º–∏–Ω—É—Ç –¥–æ 20-90 —Å–µ–∫—É–Ω–¥  
‚úÖ **–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏  
‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤  
‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏  
‚úÖ **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: –ù–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
